IF object_id(N'[dbo].[FK_dbo.T_ShopConfigStock_dbo.T_ShopConfig_ShopConfigId]', N'F') IS NOT NULL
    ALTER TABLE [dbo].[T_ShopConfigStock] DROP CONSTRAINT [FK_dbo.T_ShopConfigStock_dbo.T_ShopConfig_ShopConfigId]
IF EXISTS (SELECT name FROM sys.indexes WHERE name = N'IX_ShopConfigId' AND object_id = object_id(N'[dbo].[T_ShopConfigStock]', N'U'))
    DROP INDEX [IX_ShopConfigId] ON [dbo].[T_ShopConfigStock]
CREATE TABLE [dbo].[T_StockRule] (
    [Id] [uniqueidentifier] NOT NULL,
    [UserId] [varchar](50) NOT NULL,
    [RuleName] [varchar](50) NOT NULL,
    [Description] [varchar](200),
    [CreateDateTime] [datetime] NOT NULL,
    CONSTRAINT [PK_dbo.T_StockRule] PRIMARY KEY ([Id])
)
CREATE TABLE [dbo].[T_StockRuleProd] (
    [Id] [uniqueidentifier] NOT NULL,
    [ProdNo] [varchar](50) NOT NULL,
    [ProdName] [varchar](50) NOT NULL,
    [MtStock] [float] NOT NULL,
    [EleStock] [float] NOT NULL,
    [StockRuleId] [uniqueidentifier] NOT NULL,
    [CreateDateTime] [datetime] NOT NULL,
    CONSTRAINT [PK_dbo.T_StockRuleProd] PRIMARY KEY ([Id])
)
CREATE INDEX [IX_StockRuleId] ON [dbo].[T_StockRuleProd]([StockRuleId])
CREATE TABLE [dbo].[T_StockRuleShop] (
    [Id] [uniqueidentifier] NOT NULL,
    [ShopNo] [varchar](50) NOT NULL,
    [StockRuleId] [uniqueidentifier] NOT NULL,
    [CreateDateTime] [datetime] NOT NULL,
    CONSTRAINT [PK_dbo.T_StockRuleShop] PRIMARY KEY ([Id])
)
CREATE INDEX [IX_StockRuleId] ON [dbo].[T_StockRuleShop]([StockRuleId])
DECLARE @var0 nvarchar(128)
SELECT @var0 = name
FROM sys.default_constraints
WHERE parent_object_id = object_id(N'dbo.T_ShopConfig')
AND col_name(parent_object_id, parent_column_id) = 'MtAutoUpDown';
IF @var0 IS NOT NULL
    EXECUTE('ALTER TABLE [dbo].[T_ShopConfig] DROP CONSTRAINT [' + @var0 + ']')
ALTER TABLE [dbo].[T_ShopConfig] DROP COLUMN [MtAutoUpDown]
DECLARE @var1 nvarchar(128)
SELECT @var1 = name
FROM sys.default_constraints
WHERE parent_object_id = object_id(N'dbo.T_ShopConfig')
AND col_name(parent_object_id, parent_column_id) = 'EleAutoUpDown';
IF @var1 IS NOT NULL
    EXECUTE('ALTER TABLE [dbo].[T_ShopConfig] DROP CONSTRAINT [' + @var1 + ']')
ALTER TABLE [dbo].[T_ShopConfig] DROP COLUMN [EleAutoUpDown]
DROP TABLE [dbo].[T_ShopConfigStock]
ALTER TABLE [dbo].[T_StockRuleProd] ADD CONSTRAINT [FK_dbo.T_StockRuleProd_dbo.T_StockRule_StockRuleId] FOREIGN KEY ([StockRuleId]) REFERENCES [dbo].[T_StockRule] ([Id]) ON DELETE CASCADE
ALTER TABLE [dbo].[T_StockRuleShop] ADD CONSTRAINT [FK_dbo.T_StockRuleShop_dbo.T_StockRule_StockRuleId] FOREIGN KEY ([StockRuleId]) REFERENCES [dbo].[T_StockRule] ([Id]) ON DELETE CASCADE
INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
VALUES (N'202011200205589_202011200957', N'O2O.Model.Migrations.Configuration',  0x1F8B0800000000000400ED5DDD6EE4B615BE2FD07710E6AA2D369EB59314E9C24EE0B5771323F1DAD871D2DE2D68891E0BAB9F89446D6D147DB25EF491FA0AA5FEF92F92A23433B6E11B0F497D873C3A3C3C87A4CEF9DF7FFE7BFCC3431C795F6096876972B2383C78BDF060E2A74198AC4F1605BAFBEABBC50FDFFFF10FC7EF82F8C1FBAD6DF775D90E3F99E4278B7B84366F96CBDCBF8731C80FE2D0CFD23CBD43077E1A2F41902E8F5EBFFEDBF2F0700931C4026379DEF1C72241610CAB1FF8E7599AF870830A105DA6018CF2A61CD7AC2A54EF038861BE013E3C595C1D5D1D54AD16DE691402DC81158CEE161E4892140184BBF7E6D71CAE509626EBD5061780E8E6710371BB3B10E5B0E9F69BBEB9EE085E1F952358F60FB6507E91A33436043CFCBA61C9927DDC8AB18B8E659869EF3073D16339EA8A71278B7711FC74EAFB29E67A5DB7F058AA6FCEA2AC7C8260F041D53684F9017E3E86071CCA2BAF6BFBAA930D2C42E5DF2BEFAC885091C19304162803B8C575711B85FECFF0F126FD0C9393A48822B2DBB8E3B88E2AC045D759BA81197AFC08EF9AC15C040B6F493FB7641FEC1E239EA947F76311E2FF3F60DAE036829D50108C58A134833FC2046600C1E01A2004B3A484800DEB964A520D873EA42D452C8A78322DBC4BF0F00B4CD6E8FE64718467CFFBF001066D41D38B5F93104FBDBE575C37F548E31F5B210EF3BC7AB50AE2DF4C43BC225B1255903ED424ADA684E53083F9FD96C6B9F2D319C6F8EE6113E2419E63F96F6995FFDF84B1798FB12ECEFAD927EAF2D177037D4659614EF72C83B8CB7DB74D87F1017C09D79542605FC17DBAC917DE471855B5F97DB8A997A04A3F96B5B5726C55251E5C96C61FD3A8D1C37C8B4F37205B43DCF02655365BA545E61BF4B464BDB4A39422FF5437A53BCAB7E87A407654D0AC1D0FD9D1E365BF2A0DAE55FDE0AD17AA1EE26595122912CC1EE512A5AB494C1518A6DB0FF322417FFDC676991BE4D696144437EF5DAA08D1CC536812AB9957CE5DAB59D73FB88F736DBE35A9E4D38071F6ED34D3EE97741D26DB217D0DF2FC9F6916FC04F2FBED515F8108CD4F1DFBB5494B4D417B1AE23F43D58827F202CE61EE67E1A6F663158B8B133BB557E1A3CDD415446F8BC76B908109BA2D5D2A08FB496E525A596A22935261D0E976F812A9FBDBD74BBA2B6CC0F556DC4AD459EDC58D85345CE22E61880A907003DCC705EF650B642275AFA7FC8EDC28BFBF833006E1E966A3B46474D9AC496B05FD4CB9ACE87276603B074FB5755A608258AA67A436D3F09EDC9E8874A7C1723D60BD1DF5AA61B51E5C6581A5B7433CF9A2FD45D3097C86E4562C76F2BF3E72BF6F38D10232B83182FFD59A9B6A3295106D637C3728BACE42BF9FFD29164A2BCF262FE2B1281A0EB12357A1A47499DE86D10CB4CE61147E81999D8E15639D064106F3DC8517A945EF3D1CFB6A2F619CE26E4E3F9136C809A3AFC1E378A5B542842F6A07710E1E57F0F771186720F16174867938B9295393FA08413E87CD8BD7C022096619584D6AAE81BD2D1E1DC84EB5A88C97E27AE8D72043A7311AA906CEC37C03907F3FA8E7750F4C75C90D2A7B37042733A9AB77798E22F13E4B5BDB98C3D54FD2AC16D573BB2CC246A3365968441BBBBA7BF8C5B41690C23F83815D9589B6D14BC2DB393EC0943184CA299FE8A8D285997C81607C968C55A225CAAA8847A2F46A7D7C8F18F765B70E601B6DE84A6DB29B114ADD6AA536AF33588AB995D6A49E7D519A0252DBDA49D050D6D31C3A8E9957DA325BEE939CA5C95DB8B6125BF6F117C9DD21C91DDC039B88EE253A2D505A8945168FF361DE45D019D64C130AA5FEE78F4504EDE613FDF4139A4E23A7C8446669C9EA6770C838DD2DDA565ECB5552ECE3524D1A63AB2B23AD366543CEEB55B736BD10D13D29BF164C35D11A87A8A17C1CC2D6A3DC78018B6CD5D193B44D47DA7D137ACADB514997A87ADF237D4ABC64BB80E9446F57DD5362EE4FA7F558A7554F478ED316D6B7F60508CF465B0CDADA13CDD9A7324DC62DAAD269A25C8275A6C9699EA77E58755BF8614B77F79F66C7BB24F0F43E04A8E585FFA8000B0F9E1DE106CF07FCEB64F1178EE583343A5383A6C1DC9FA4C91C7264F0B48259E9E882A8BC2D80276A98207E0E86891F6E40A4D523E669CD395CBEA48E0E5B730E373029FD712DB6EB7480F83C85EF47478ED13243CC3A5E1202A59633F19D2B99080C5CC0EA2580BF40AB2F6703B77E7B22E4272893C897B22733889792DD3AF45B87772BA225B98EAE522F7AC235A85E86B4D88E8897BA2B33A9AF3D1630E1018DECBDAB4F6BFAB7CE9E4AEB4B96FA189DA120132C968F57C9398C2082DEA95F478B3803B90F02DE34C29645E040265583984122556F49877C77D4B8158154BB6332B9D1F4CD7A0112EEB8E8CBA9E60E9880DEAE0AADD68866905EAD37A9D30FCADFDAAE280B5DA641D152FB4F02D1B27349343741F7519455239A5394556F721745B9EE2B7E06E12760D6AE0B475765117C4082DD266CC4341B4E79738D9895B7127205116FD82EBCDEA1975BA79CFCF278259B2560E4D41840AA3F98E150484B7600A177390438BC573780D6DC99E18028134807039B043218C2561B406A6EBF0880983B350338FD750401147FD56108ADDF88E2C15875A58B2519A7D072D0C59488A850853398C45CE5C59ED9E2F288C6EA4018AC32D1DE0EEB8648CE3D4E3769EF7C3170DD40D81582E6820687241FC4F10CD2D8C531D8C721C643AA030583D45B36045E3D80D18C917DE92E161D23D60C6C43E8BD6B931D07F7DC115F5CE47933EC3FEB7BD0C4287A85AD608AD25966C11CF064E0A48C678E812F67E1CD11236474B682677A8E9B08DA2503C567280A060E7B10163E846894837A5CCF5D18C9C0F68CA73341BBBAE3651DA0B429385E4A22991E5F82CD264CD64464D3A6C45BD5614DCFBE5A9907FE8C6B8CA59F0BE27F76BDED28A134036BC8D496DF7206F07D98E5E81C20700BCA43BAB320E69A1106B7C4BC6809F13635FF025B93A37DA6FCBF33ECDB0362CEEEE6DD93E6F9F7786471E9EB54572EC52A5D86E1956166410432C1C9EE591A157122F7BFE44F1341304810A2D81CABBADD2142AB2A8CF0FA589D0C5E5FA18F4784DF24D188627D2C3AC0260947D7E82336413349A8A6481F830A8949225115FA78ED2E3B0925DB7997A3B087EF241A5BC7A31E2F99C9C3B9F2DC34E53648E899AFAD172ABD6EAF1408BFC44E23A800A65107ED3D0F4A0A9B323314B61F6D99B13A61811407D772ACBD144189C3A0237EC4C68BB9E8A91E9E46ECFA080BACA6315D33881082241451AC8F45C70424E1E81A73C43ACE9F08B1AE31106C22761F25D444B93E5A158C8F84F999BD48A47E9EBAF54DE2501536D35636658DD412113D8F524D44F9CE4C7E6203C44E05707BA6E68A6018E2F919A5AE459C0A9046E2511516786D943021665B69603CD3C1CE28039AAEB2C1147596AF7D315C3514876C374D476790C723E6EA42F9F4349AA28FE245494E573AB7C4B8B19FBBCB24248CF48689823B5D142D8A3B5DA991995107D2626C8CBA701B861E192A8BC56ACB4DB43A110C8BD6EA4485315E17104B00D9D519A35661AF048855B93E5A17FB8A84EA0A0DA4B58D6D45496B5B68621C3FF253B92B34988388B3179B22034E37F1AD282E376506B3868870454D1CA2DC14AD8DF5C4E3B535469B585DA02A660BAB2B374513F58FAED147ECE34D91687DA9A146E5A58B28361D6717788A1F685765206F4C002A4AEE983A1B5491A6E46B9F8365549E0F8E308EFA4B1F96F69102601A13A9FDD093D2AA4D99210A279A7DA919521D2A8945AA4B4D9038DBC6D8B0E9421F510C6E0BCD70AAE0472C4E5568A35CB85E3155F39B937B39E9DBBB5776739EBE9F653EE5079E9F6E3775BC2BE3466FECA5CC10F7ECECC486BB8B672E39C310BB2C3C6EFC6026D20EE5A7D0550647A44CC81DEA9494A97BEA62AEB814A325E5CC25510B211F42D86519EF83EB50AB7457BA0BC726FB288D23966BD135E3115239FFD2BD6BC67A173385D6BD4DA191D61500F5A526BB3BC4671DF41E8FE27B0F39DE7ECF9511375444D7E747CC95BDBDABF27CE489BB20CA36E9A83725DDEFEE8268733993BA355A71A2BC035A71206F2E8AB2B735EB260B0FB3EB4B18943735578F39F68F0FCA0607ABDFA3B32884A55FDB36B8044978077354C7CA591CBD3E3C5A78A75108F2FA9EEF2EE5B55FE679406D2BD925B7BF4802F870B2F897F7EFF9C3021549F87B01C32AE6E75D585E7D1F0C0B6A99F4AC0B23F40564FE3DC8B8989DE393A9B9436693C58B90BF3147E632C18B700F295C9D3423A2B4EF8E7A4CE57477D35B4102F700FF8FC627704FBA0ECAE758F9DC1BEFE21F9FEA475F79D58ED81BEF359E7D5C963327E1A63407E72E07F9D3D627744CB26191D406ED07711BAEC3724D1A9BFA9B6786865C7628B468EEA4282A93726F530C13A15C584C6936099808F75B7379E3525E3BC215E5B3760C4D26AB7604CD67A216039B231369A61D19078208C7621D64BC2EF209A3AD97453E61B4551F5DE62F7EDA8BD2968D5C8B39A729C747E6722CC8FD3BCC0D23603A13EE304374C085597D5D434FD1F1E76802ABF3E33E6D55C366B0B5B154699971A4AB68C3BC15C43FC5E0E1CFA632CD647072D44136BBEC5D940273DE31C965ED4074CC4A0B13824F24EB08589035D6DA3811678DD5B0F80C3A4AA488B57B414C86D871D24C6781B5661C9305D666E253793C6D00E80CB036087CFE5737EBA028D9AB238B86CFECEAA6CBA234AE8EBACCE66CB579535CC6561B1061BE56BB39294ED73ABCD1A9A53724B959DDA0CF6815A9129C3E6DC3A83D30D79E4756894B5CEDA63099431DED633AB06F98ACA0F6204452503B10614E503B28C6A0B4DA986D30F6605B762865E7D3D6039338373ACA6547A5412319E68B404C700C65012ACC3169637589334C5A99EBF3C8E8607EC9DD1251E712686142B0591E777E63786651DAA325D0F9626469914E204E4CFA3D3BF38DCDBE678722C82A66650812387B600CEA65C0DBEBF930BC165B08EEB390162789E098A3DFBA63B689D96451B047259573932E69FE0C6F4F30A51B79658878A326C9AFE471C047E684B3121365CC3DE7F2A111DE8BA7B94F69D99CCAC748EDB4971262A7B6F62CB19AE06DCE95E64C16537E545637FBDC69F309D660200C9EE25EA74713BCD639D33929E3F08FCFCF362E5BD47C52A7F76D274F76EF539AED9EF8498C71AB9C6A7B277E8646F96EA421E39327B02FB9F96A5066ABE9E51BAB3FF2C3CEE86DE984D74EA82A3391882C293C429A6403194151460E61D2322925B25244E5E69330690E4B83F73D384A7C13113D79422471E2322939AA563C3271EE1B2119C2B41153221A288809B2F6C8B2A849C931F5626A5D2AB60162FC5919478F6F222649666D1BA2CAEA759E28DB4242539A3F464A52C95B61AB01D27A7C16AD1972F243739F202F5401DBC807279CFF92AC2FFC0A21DF0663801459F07628011CAF73D994032A16C8B4A9385AF978364C98EE6D1C2346CAD58EE576130C4191A853E97AB310F2249DFB90CA4D30AA81CC9CC3FEA2088BAC77C7A6D912B6B9629344BBEA241A7592968D8FAE811D013C89C3B83EABC14E491EAE7B88E3F27B49E8532E40D7E622B94B5B7784E951DB84BBEA8E4080FD83D30C8577C047B8BA8C7F507D8DF91B888A52EFC4B730B848AE0AB429101E328C6F238A19A547A3A25FE59EA3FB7C7C55DD31C85D0C0177332C4FC2AE92B74518055DBFDF0B4EC22410A5ABD4DC392ADF252AEF1EAD1F3BA40F69A209D4B0AFF3F06E60BC8930587E95ACC01768D337BC3AFC02D7C07FBC6E82A4C841865F04CDF6E3F310AC3310E70D46FF3CFE896538881FBEFF3F2DCD4B218AC50000 , N'6.4.4')

